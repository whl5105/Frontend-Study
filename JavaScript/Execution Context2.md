[Notion 정리자료 보러가기](https://www.notion.so/938e0a47870a44369d5b1331c8644ef2?pvs=4)

### 정의
- 실행 컨텍스트란 자바스크립트가 실행되는 환경을 정의하며 , 조금 더 구체적으로는 코드를 실행하는데 필요한 환경( this, 변수, 객체, 함수 등 코드의 실행에 필요한 기반)을 제공하고, 관리합니다.
- 식별자, 스코프, this 등 →  실행 컨텍스트의 **렉시컬 환경**을 기반으로 **관리**합니다.
- 코드의 실행순서 →  **[콜스택(실행 컨텍스트 스택)](https://www.notion.so/938e0a47870a44369d5b1331c8644ef2)**을 통해서 **관리** 합니다.

### 실행 컨텍스트의 종류
1. **Global Execution Context**
    - 처음으로 자바스크립트 코드가 **실행**될 때 생성되는 실행 컨텍스트입니다.
    - **전역**에서 관리되는 값들(함수나, 별도 모듈로 분리되어 있지 않은 값)을 관리합니다.
2. **Function Execution Contex**t
    - 함수가 **호출**될 때 마다 생성되는 실행 컨텍스트입니다.
    - 각각의 함수 호출은 모두 각자의 실행 컨텍스트를 생성하고 가집니다.
    - 각각의 함수의 호출이 끝났을때 (return문을 만났을때) 실행컨텍스트는 **종료** 됩니다.
3. 그 외에도 **Eval Execution Context**와. **Module Execution Context**가 존재합니다.

**Eval Execution Context , Module Execution Context (잘 사용되지 않습니다.)**

1. **Eval Execution Context -** 스트링으로 된 코드를 실행 (악성코드를 그대로 실행시킬 수 있기때문에 잘 사용하지 않습니다.)
2. **Module Execution Context -** ES6 Module : import export  / commonJs Module **:** require ,export ,import 등 파일마다의 범위

### 실행 컨텍스트 구성 (콜스택)
> 스택은 LIFO(Last In, First Out)의 특징을 가진 자료구조

자바스크립트는 스택에 실행 컨텍스트를 순차적으로 추가하고 제거하면서 코드의 순서를 관리하면서 실행합니다.

```jsx
// 1. **전역 실행 컨텍스트 생성**

const a = 'a'; 

function foo() {
  const b = 'b'; 
  bar(); **//3. foo 함수 안에서 bar를 호출**

  function bar() {  
    const c = 'c';
    if(true){
      console.log("Hello, World")
    }

}

foo(); **//2.foo 함수 호출**

```

처음에는 실행 컨텍스트 스택은 비어있습니다.

1. 자바스크립트 코드가 실행 → **전역 실행 컨텍스트 생성**
    1. 전역 스코프에 선언된 변수와, 함수등의 정의가 진행
2. foo 함수 호출 → foo 함수의 **함수 실행 컨텍스트가 생성**
3. foo 함수 안에서 bar를 호출 →  bar 함수의 **실행 컨텍스트가 생성**
4. bar 함수의 동작이 완료 → bar 함수의 **실행 컨텍스트가 스택에서 제거**
5. foo 함수의 동작이 완료 → foo 함수의 **실행 컨텍스트가 스택에서 제거**
6. 모든 코드의 실행이 종료 → **전역 실행 컨텍스트가 스택에서 제거**

이를 통해 자바스크립트는 스택 구조안에 실행 컨텍스트를 추가하고 제거하면서 현재 무슨 코드가 실행되어야 하는지 파악하고, 개별 코드의 실행이 종료되면 다시 어느 코드로 돌아가서 동작을 이어가야 하는지를 관리합니다.

> 실행 컨텍스트는 종류별로 세부적인 구성요소와 동작이 다릅니다. 하지만 모든 실행 컨텍스트는 평가와 실행의 과정을 거쳐서 생성되고 관리됩니다.

#### 평가
실행 컨텍스트를 생성하고 변수, 함수 등의 선언문을 파악해서 현재 스코프 내에서 사용할 수 있는 변수, 함수의 식별자를 실행 컨텍스트에 등록하는 과정입니다.

여기서 호이스팅이란 개념이 나옵니다. 

평가 과정에서 식별자들에 대한 정보(참조할 수 있는 변수나 함수)를  파악하 있기 때문에  이런과정이  **실행 전** 코드블럭의 제일 상위 부분으로 끌어올려지는 것 같은 현상을 호이스팅이이라고 합니다

#### 실행
실행이란 선언문을 제외한 소스코드를 실행하는 과정을 의미합니다. 이 과정에서는 소스코드 실행에 대한 필요한 정보, 즉 변수나 함수의 참조를 실행 컨텍스트에서 찾고 실행과정에서 일어나는 변수값의 변경 등은 다시 실행 컨텍스트에 등록됩니다.


### 실행컨텍스트 동작원리
> 실행 컨텍스트의 내부에는 **LexicalEnvironment**라는 객체가 존재합니다. LexicalEnvironment는 **스코프를 관리하는 역할을 수행**하며, 이 안에 **변수, 함수의 정의와 값들이 저장**되게 됩니다.
> 
1. **Lexical Environment** 의 두가지 프로퍼티
    1. **Declarative Environment Record :** let, const로 선언한 변수를 관리
    2. **Object Environment Record :** 그 외의 영역(var, 전역 함수, 빌트인 프로퍼티 등)을 관리
2. **Environment Record(환경 레코드)**: **식별자를 등록**하고 **관리**하는 저장소
3. **Outer Lexical Environment Reference(외부 렉시컬 환경에 대한 참조)**: **상위 스코프를 참조**하는 역할, 이를 통해 **상위 영역에 있는 식별자에도 접근**할 수 있게 된다.
4. BindingObject :  전역객체 에 참조되는값을 정의 

 Lexical Environemnt는 평가과정에서 일반적으로 크게 3가지의 동작

1. 식별자 생성
2. this binding
3. 참조할 외부 환경 결정



### 정리
실행 컨텍스트는 **소스 코드를 실행하는데 필요한 환경을 제공하고, 코드의 실행결과를 실제로 관리하는 영역입니다.** 이 실행 컨텍스트를 통해서 **스코프, 클로저등의 동작**과 **코드의 실행 순서 관리**가 구현됩니다. 실행 컨텍스트는 소스코드의 타입에 따라서 실행 컨텍스트를 생성하는 과정과 컨텍스트 내부에서 관리하는 내용이 달라집니다.

또한, **실행 컨텍스트와 렉시컬 환경은 별도의 객체**입니다. 실행 컨텍스트에서 렉시컬 환경을 참조하고는 있지만, 실행 컨텍스트가 종료된 후에도 해당 렉시컬 환경이 어딘가에서 참조되고 있다면 렉시컬 환경은 가비지 컬렉팅 대상에서 제외됩니다. 이러한 동작으로 인해 클로저라는 개념이 성립하게 됩니다.


Reference : 원티드 프론트엔드 프리온보딩 인턴쉽
https://pollen-port-115.notion.site/145ce592a18a40dabec08182ed6b4dbf
